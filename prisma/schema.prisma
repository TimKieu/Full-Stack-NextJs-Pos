// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Company {
  id        Int        @id @default(autoincrement())
  name      String     @db.VarChar(50)
  createdAt DateTime   @default(now())
  address   String
  tax       String     @db.VarChar(30)
  phone     String     @db.VarChar(10)
  email     String     @db.VarChar(50)
  logo      String     @unique @db.VarChar(50)
  status    enumStatus @default(Active)
  branchs   Branch[] // one to maney
  products  Product[]
  units     Unit[]
}

model Branch {
  id          Int        @id @default(autoincrement())
  name        String     @db.VarChar(50)
  codeReceipt String     @db.VarChar(10)
  address     String
  createdAt   DateTime   @default(now())
  expiration  DateTime
  phone       String     @db.VarChar(10)
  company     Company    @relation(fields: [companyId], references: [id]) // Foreign Key
  companyId   Int
  status      enumStatus @default(Active)
}

model Product {
  id            Int         @id @default(autoincrement())
  name          String      @db.VarChar(50)
  cost          Float       @default(0.00)
  price         Float       @default(0.00)
  img           String      @unique @db.VarChar(50)
  unit          Unit        @relation(fields: [unitId], references: [id])
  unitId        Int
  productType   ProductType @relation(fields: [productTypeId], references: [id])
  productTypeId Int
  company       Company     @relation(fields: [companyId], references: [id])
  companyId     Int
  status        enumStatus  @default(Active)
}

model Unit {
  id        Int        @id @default(autoincrement())
  name      String     @db.VarChar(50)
  company   Company    @relation(fields: [companyId], references: [id])
  companyId Int
  status    enumStatus @default(Active)
  Products  Product[]
}

model ProductType {
  id        Int        @id @default(autoincrement())
  name      String     @db.VarChar(50)
  companyId Int
  status    enumStatus @default(Active)
  Products  Product[]
}

model Promotion {
  id               Int        @id @default(autoincrement())
  name             String     @db.VarChar(50)
  detail           String
  promotionalPrice Float      @default(0.00)
  startDate        DateTime
  endDate          DateTime
  img              String     @db.VarChar(50)
  companyId        Int
  status           enumStatus @default(Active)
}

model itemPromotion {
  id          Int        @id @default(autoincrement())
  productId   Int
  price       Float      @default(0.00)
  companyId   Int
  promotionId Int
  status      enumStatus @default(Active)
}

model employee {
  id         Int        @id @default(autoincrement())
  name       String     @db.VarChar(50)
  subname    String     @db.VarChar(50)
  age        Int
  cardId     String     @db.VarChar(30)
  userName   String     @unique
  passWord   String
  companyId  Int
  branchId   Int
  positionId Int
  status     enumStatus @default(Active)
}

model Position {
  id        Int        @id @default(autoincrement())
  name      String     @db.VarChar(50)
  salary    Float      @default(0.00)
  companyId Int
  status    enumStatus @default(Active)
}

model tables {
  id         String     @id @unique @default(uuid())
  name       String     @db.VarChar(50)
  stoves     Int
  people     Int
  expiration Int // เวลาหมดโต๊ะ (นาที)
  branchId   Int
  companyId  Int
  status     enumStatus @default(Active)
}

model Stock {
  id        Int @id @default(autoincrement())
  productId Int
  qty       Int
  branchId  Int
}

model transaction {
  id         Int        @id @default(autoincrement())
  tableId    String
  receipt    String     @db.VarChar(30)
  startOrder DateTime
  endOrder   DateTime
  peoples    Int
  totalPrice Float      @default(0.00)
  branchId   Int
  employeeId Int
  status     enumStatus @default(Active)
}

model itemTransaction {
  id            Int @id @default(autoincrement())
  qty           Int
  productId     Int
  transactionId Int
}

model expenses {
  id        Int        @id @default(autoincrement())
  name      String     @db.VarChar(50)
  companyId Int
  status    enumStatus @default(Active)
}

model itemExpenses {
  id         Int   @id @default(autoincrement())
  price      Float @default(0.00)
  expensesId Int
  branchId   Int
  companyId  Int
}

enum enumStatus {
  Active
  InActive
}
